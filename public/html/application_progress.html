<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Application Progress - PSAU Admission System</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
     <!-- Mobile Navigation -->
     <?php include 'templates/mobile.html'; ?>
    
     <!-- Desktop Navigation -->
     <div class="desktop-nav">
         <!-- Navigation Bar -->
         <?php include 'templates/navbar.html'; ?>
         
         <!-- Sidebar -->
         <?php include 'templates/sidebar.html'; ?>
     </div>
    
    <!-- Main Content -->
    <div class="main-content">
        <div class="container-fluid">
            <!-- Page Title -->
            <div class="page-title">
                <h2><i class="bi bi-graph-up me-2"></i> Application Progress</h2>
                <p class="lead">Track your application journey through the PSAU admission process</p>
            </div>
            
            
            
            <!-- Application Progress Content -->
            <div id="application-progress-content">
                <!-- This will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- HTML Templates -->
    <template id="no-application-template">
        <div class="card">
            <div class="card-body text-center py-5">
                <i class="bi bi-file-earmark-x display-1 text-muted"></i>
                <h3 class="mt-4">No Application Submitted</h3>
                <p class="lead">You haven't submitted your application yet. Start your admission journey by submitting an application.</p>
                <a href="application_form.php" class="btn btn-success btn-lg mt-3">
                    <i class="bi bi-file-earmark-plus me-2"></i> Start Application
                </a>
            </div>
        </div>
    </template>

    <template id="application-overview-template">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Application Status Overview</h5>
                <span class="badge bg-${statusClass} status-badge">${status}</span>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>Application ID:</strong> ${app.id}</p>
                        <p><strong>Submitted on:</strong> ${formatDate(app.created_at)}</p>
                        <p><strong>Last Updated:</strong> ${formatDate(app.updated_at)}</p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Control Number:</strong> ${user.control_number}</p>
                        <p><strong>Name:</strong> ${user.first_name} ${user.last_name}</p>
                        <p><strong>Email:</strong> ${user.email}</p>
                    </div>
                </div>
                <div id="rejection-alert"></div>
            </div>
        </div>
    </template>

    <template id="rejection-alert-template">
        <div class="alert alert-danger mt-3">
            <h5><i class="bi bi-exclamation-triangle-fill me-2"></i> Application Rejected</h5>
            <p>Unfortunately, your application has been rejected for the following reason:</p>
            <p class="mb-0 fw-bold">${app.rejection_reason}</p>
            <hr>
            <p class="mb-0">You may submit a new application addressing the issues mentioned above. If you need assistance, please contact the admissions office.</p>
        </div>
    </template>

    <template id="progress-tracker-template">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Application Progress</h5>
            </div>
            <div class="card-body">
                <div class="progress-tracker">
                    <div class="progress-steps">
                        ${stepsHtml}
                    </div>
                    
                    <div class="progress-bar-container">
                        <div class="progress-bar-fill" data-progress="${progressPercent}"></div>
                    </div>
                    
                    <p class="text-center">
                        <span class="badge bg-${statusClass} px-4 py-2">
                            ${status === 'Rejected' ? 'Application Rejected' : 'Current Stage: ' + status}
                        </span>
                    </p>
                </div>
            </div>
        </div>
    </template>

    <template id="stage-details-template">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Current Stage Details</h5>
            </div>
            <div class="card-body">
                ${detailsHtml}
            </div>
        </div>
    </template>

    <template id="timeline-template">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Application Timeline</h5>
            </div>
            <div class="card-body">
                <div class="timeline">
                    ${timelineItems}
                </div>
            </div>
        </div>
    </template>

    <!-- Stage Details Templates -->
    <template id="rejected-stage-template">
        <div class="stage-details rejected-details">
            <h5><i class="bi bi-x-circle me-2"></i> Application Rejected</h5>
            <p>Your application was reviewed and rejected on ${formatDate}.</p>
            <p><strong>Reason:</strong> ${rejectionReason}</p>
            <div class="mt-3">
                <a href="application_form.php" class="btn btn-primary">Submit New Application</a>
            </div>
        </div>
    </template>

    <template id="submitted-stage-template">
        <div class="stage-details">
            <h5><i class="bi bi-file-earmark-check me-2"></i> Application Submitted</h5>
            <p>Your application has been submitted and is waiting for verification by the admissions office.</p>
            <p><strong>Submitted on:</strong> ${submittedDate}</p>
            <div class="alert alert-info mt-3">
                <i class="bi bi-info-circle me-2"></i> 
                The verification process usually takes 2-3 business days. You will receive an email notification once your application has been verified.
            </div>
        </div>
    </template>

    <template id="verified-stage-template">
        <div class="stage-details">
            <h5><i class="bi bi-check-circle me-2"></i> Application Verified</h5>
            <p>Your application has been verified by the admissions office.</p>
            <p>The next step is the scheduling of your entrance examination. You will receive an email with the exam details once scheduled.</p>
            <div class="alert alert-info mt-3">
                <i class="bi bi-info-circle me-2"></i> 
                Please make sure your contact information is up to date as you will be notified about your exam schedule via email or SMS.
            </div>
        </div>
    </template>

    <template id="exam-scheduled-stage-template">
        <div class="stage-details">
            <h5><i class="bi bi-calendar-event me-2"></i> Entrance Examination Scheduled</h5>
            <div class="row mt-3">
                <div class="col-md-6">
                    <p><strong>Exam Date:</strong> ${examDate}</p>
                    <p><strong>Exam Time:</strong> ${examTime}</p>
                    <p><strong>Venue:</strong> ${examVenue}</p>
                </div>
                <div class="col-md-6">
                    <div id="exam-instructions"></div>
                    <div id="exam-requirements"></div>
                </div>
            </div>
            <div class="alert alert-warning mt-3">
                <i class="bi bi-exclamation-triangle me-2"></i> 
                Please arrive at least 30 minutes before the scheduled time. If you're unable to attend, please contact the admissions office immediately.
            </div>
        </div>
    </template>

    <template id="exam-instructions-template">
        <div class="mb-3">
            <h6>Important Instructions:</h6>
            <p>${instructions}</p>
        </div>
    </template>

    <template id="exam-requirements-template">
        <div>
            <h6>Items to Bring:</h6>
            <p>${requirements}</p>
        </div>
    </template>

    <template id="score-posted-stage-template">
        <div class="stage-details">
            <h5><i class="bi bi-clipboard-data me-2"></i> Entrance Exam Score Posted</h5>
            <p>Your entrance examination has been scored.</p>
            <div class="card bg-light mb-3">
                <div class="card-body">
                    <h6 class="card-title">Your Score Details</h6>
                    <p class="mb-1"><strong>Stanine Score:</strong> ${stanineScore}</p>
                    <p><strong>Score Posted on:</strong> ${scorePostedDate}</p>
                </div>
            </div>
            <p>The next step is to select your preferred courses. Please visit the Course Selection page to submit your preferences.</p>
            <div class="mt-3">
                <a href="course_selection.php" class="btn btn-primary">Select Courses</a>
            </div>
        </div>
    </template>

    <template id="course-assigned-stage-template">
        <div class="stage-details">
            <h5><i class="bi bi-mortarboard me-2"></i> Course Assignment</h5>
            <p>Based on your qualifications and course preferences, you have been assigned to the following course:</p>
            <div class="card bg-light mb-3">
                <div class="card-body">
                    <h6 class="card-title">Assigned Course</h6>
                    <p class="mb-1"><strong>Course Name:</strong> ${courseName}</p>
                    <p class="mb-1"><strong>Course Code:</strong> ${courseCode}</p>
                    <p><strong>Assigned on:</strong> ${assignedDate}</p>
                </div>
            </div>
            <p>The next step is the scheduling of your enrollment. You will receive an email notification once your enrollment has been scheduled.</p>
        </div>
    </template>

    <template id="enrollment-scheduled-stage-template">
        <div class="stage-details">
            <h5><i class="bi bi-calendar-check me-2"></i> Enrollment Schedule Set</h5>
            <p class="text-success"><strong>You are now eligible for enrollment!</strong></p>
            <p>Your enrollment has been scheduled. Please ensure you attend on the specified date and time.</p>
            <div class="row mt-3">
                <div class="col-md-6">
                    <p><strong>Enrollment Date:</strong> ${enrollmentDate}</p>
                    <p><strong>Enrollment Time:</strong> ${enrollmentTime}</p>
                    <p><strong>Venue:</strong> ${venueName}</p>
                </div>
                <div class="col-md-6">
                    <div id="enrollment-instructions"></div>
                </div>
            </div>
            <div class="alert alert-warning mt-3">
                <i class="bi bi-exclamation-triangle me-2"></i> 
                Please bring all required documents for enrollment as specified in the enrollment guidelines. Failure to appear on the scheduled date may result in forfeiture of your slot.
            </div>
            <div class="mt-3">
                <a href="enrollment_eligibility.php" class="btn btn-primary">Proceed to Enrollment</a>
            </div>
        </div>
    </template>

    <template id="enrollment-instructions-template">
        <div>
            <h6>Important Instructions:</h6>
            <p>${instructions}</p>
        </div>
    </template>

    <template id="enrolled-stage-template">
        <div class="stage-details">
            <h5><i class="bi bi-flag me-2"></i> Enrollment Eligible</h5>
            <p>Congratulations! You have completed the admission process and are now eligible to enroll at PSAU.</p>
            <div class="alert alert-success mt-3">
                <i class="bi bi-check-circle me-2"></i> 
                Welcome to PSAU! You are now eligible for enrollment.
            </div>
        </div>
    </template>

    <!-- Application Stages Templates -->
    <template id="stage-submitted-template">
        <div class="progress-step">
            <div class="step-icon"><i class="bi bi-file-earmark-check"></i></div>
            <div class="step-name">Submitted</div>
            <div class="step-description">Application submitted and waiting for verification</div>
        </div>
    </template>

    <template id="stage-verified-template">
        <div class="progress-step">
            <div class="step-icon"><i class="bi bi-check-circle"></i></div>
            <div class="step-name">Verified</div>
            <div class="step-description">Application verified by admissions office</div>
        </div>
    </template>

    <template id="stage-exam-scheduled-template">
        <div class="progress-step">
            <div class="step-icon"><i class="bi bi-calendar-event"></i></div>
            <div class="step-name">Exam Scheduled</div>
            <div class="step-description">Entrance examination scheduled</div>
        </div>
    </template>

    <template id="stage-score-posted-template">
        <div class="progress-step">
            <div class="step-icon"><i class="bi bi-clipboard-data"></i></div>
            <div class="step-name">Score Posted</div>
            <div class="step-description">Exam scores have been posted</div>
        </div>
    </template>

    <template id="stage-course-assigned-template">
        <div class="progress-step">
            <div class="step-icon"><i class="bi bi-mortarboard"></i></div>
            <div class="step-name">Course Assigned</div>
            <div class="step-description">Course has been assigned based on qualifications</div>
        </div>
    </template>

    <template id="stage-enrollment-scheduled-template">
        <div class="progress-step">
            <div class="step-icon"><i class="bi bi-calendar-check"></i></div>
            <div class="step-name">Enrollment Scheduled</div>
            <div class="step-description">Enrollment schedule has been set</div>
        </div>
    </template>

    <template id="stage-enrolled-template">
        <div class="progress-step">
            <div class="step-icon"><i class="bi bi-flag"></i></div>
            <div class="step-name">Enrolled</div>
            <div class="step-description">Eligible to enroll at PSAU</div>
        </div>
    </template>

    <!-- Stage Details Card Template -->
    <template id="stage-details-card-template">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Current Stage Details</h5>
            </div>
            <div class="card-body">
                ${detailsHtml}
            </div>
        </div>
    </template>

    <!-- Timeline Item Template -->
    <template id="timeline-item-template">
        <div class="timeline-item">
            <div class="timeline-date">${date}</div>
            <div class="timeline-content">
                <h6>${status}</h6>
                <p>${description}</p>
            </div>
        </div>
    </template>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JavaScript -->
    <script src="js/common.js"></script>
    <script src="js/application_progress.js"></script>
</body>
</html> 